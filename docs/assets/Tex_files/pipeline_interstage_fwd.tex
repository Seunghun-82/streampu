\documentclass{standalone}

\usepackage{tikz}
\usetikzlibrary{aff3ct}

\begin{document}
  \begin{tikzpicture}
    %%%%%%%%%%%%%%%%%%
    %% create tasks %%
    %%%%%%%%%%%%%%%%%%
    %     options                          id   coords  label               sin sout sfwd attributes
    %     -------                          --   ------  -----               --- ---- ---- ----------
    \task                                  {t1} {0, 0}  {$Init$}            {0} {1}  {0}  {"seq"};
    \task [right=1.0cm of t1]              {t2} {}      {$Rely_{fwd_0}$}    {0} {0}  {1}  {"seq"};
    \task [right=1.0cm of t2]              {t3} {}      {$Inc_{fwd_0}$}     {0} {0}  {1}  {};
    \task [right=1.0cm of t3]              {t4} {}      {$Rely_{fwd_1}$}    {0} {0}  {1}  {"seq"};
    \task [right=1.0cm of t4]              {t5} {}      {$Inc_{fwd_1}$}     {0} {0}  {1}  {};
    \task [right=1.0cm of t5]              {t6} {}      {$Comp$}            {0} {0}  {2}  {"seq"};
    \task [right=1.0cm of t6]              {t7} {}      {$End$}             {1} {0}  {0}  {"seq"};

    %%%%%%%%%%%%%%%%%%%%
    %% create modules %%
    %%%%%%%%%%%%%%%%%%%%
    %       options      task ids         id   label
    %       -------      --------         --   -----
    \module              {"t1"}           {m1} {$M_1$};
    \module              {"t2"}           {m2} {$M_2$};
    \module              {"t3"}           {m3} {$M_3$};
    \module              {"t4"}           {m4} {$M_4$};
    \module              {"t5"}           {m5} {$M_5$};
    \module              {"t6"}           {m6} {$M_6$};
    \module              {"t7"}           {m7} {$M_7$};

    %%%%%%%%%%%%%%%%
    %% bind tasks %%
    %%%%%%%%%%%%%%%%
    %     options start id                            path                                end id
    %     ------- --------                            ----                                ------
    \draw [bind]  (t1_so1)                            --                                  (t2_si1);
    \draw [bind]  (t2_so1)                            --                                  (t3_si1);
    \draw [bind]  (t2_so1)              --++ (0.50,0) --++ (0.0,1.0) --++ (6.0,0.0)   |-  (t5_si1);
    \draw [bind]  (t3_so1)              --                                                (t4_si1);
    \draw [bind]  (t4_so1)              --++ (0.30,0) --++ (0.0,-1.0) --++ (3.0,0.0)  |-  (t6_si2);
    \draw [bind]  (t5_so1)                            --                                  (t6_si1);
    \draw [bind]  (t6_so1)                            --                                  (t7_si1);
    
    %%%%%%%%%%%%%%%%%%%
    %% create stages %%
    %%%%%%%%%%%%%%%%%%%
    %      options                       object ids       id   label     n threads 
    %      -------                       ----------       --   -----     ---------
    \stage [minimum height=3.00cm]       {"m1","m2"}      {s1} {Stage 1} {1}
    \stage [minimum height=3.00cm]       {"m3"}           {s2} {Stage 2} {3}
    \stage [minimum height=3.00cm]       {"m4"}           {s3} {Stage 3} {1}
    \stage [minimum height=3.00cm]       {"m5"}           {s4} {Stage 4} {3}
    \stage [minimum height=3.00cm]       {"m6","m7"}      {s5} {Stage 5} {1}

     %%%%%%%%%%%%%%%%%%%%%
    %% clone the tasks %%
    %%%%%%%%%%%%%%%%%%%%%
    %      options      task ids         n clones
    %      -------      --------         --------
    \clone []           {"t3","t5"}      {2}

    %%%%%%%%%%%%%%%%%%%%%
    %% draw the legend %%
    %%%%%%%%%%%%%%%%%%%%%
    \legend [shift={(-1.0,2.0)}]
  \end{tikzpicture}
\end{document}
